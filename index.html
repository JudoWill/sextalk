<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>PhillyQS: Sex Talk</title>
    
    <meta name="description" content="">
    <meta name="author" content="Will Dampier">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" 
	  content="black-translucent" />

    <meta name="viewport" content="width=device-width, 
				   initial-scale=1.0, 
				   maximum-scale=1.0, 
				   user-scalable=no">

    <link rel="stylesheet" href="reveal.js/css/reveal.css">
    <link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

    <!-- For LaTeX formating highlighting -->
    <link rel="stylesheet" href="css/latex_style.css">

    <!--[if lt IE 9]>
	<script src="reveal.js/lib/js/html5shiv.js"></script>
	<![endif]-->
  </head>

  <body>

    <div class="reveal"><div class="slides">
	<section class="vertical-stack">
<section class="vertical-slide" >
<link rel="stylesheet" href="css/one_moz.css" id="theme">
<br>
<p>
<h1>The Joy Of (Quantifying) Sex</h1>A spoonful of sex helps the statistics go down.<br>Will Dampier, PhD</p>
</section>
</section><section class="vertical-stack">
<section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Quantification Topics</h2></div></p>
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Stress</h2></div></p>
<br>
<p>
<div display='inline' align='left'>Use python <code>imaplib</code> to parse emails from work contacts.</div></p>
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Sexual Satisfaction</h2></div></p>
<br>
<p>
<div display='inline' align='left'>Use python and <code>statsmodels</code> to find patterns in which <em>tags</em> I gave to each encounter.</div></p>
</section>
</section><section class="vertical-stack">
<section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Gmail Access</h2></div></p>
<br>
<p>
Pretty dang easy!</p>
<pre><code class=python>import imaplib
imap_server = imaplib.IMAP4_SSL("imap.gmail.com",993)
imap_server.login('judowill', open('SUPERSECRET.txt').read())
imap_server.select('[Gmail]/All Mail')</code></pre>
<br>
<pre><code class=python>def get_emails_person(address):
    search = '(OR (TO "%(name)s") (FROM "%(name)s"))'
    status, response = imap_server.search(None, search % {'name':address})
    ids = response[0].split()
    for _id in ids:
        yield _id</code></pre>
<br>
<pre><code class=python>def get_date_from_ids(ids):
    resp, data = imap_server.FETCH(','.join(ids), 'RFC822.HEADER')
    id_iter = iter(ids)
    for d in data:
        msg = email.message_from_string(d[1])
        date = dateutil.parser.parse(msg['DATE'])
        yield id_iter.next(), date</code></pre>
</section>
</section><section class="vertical-stack">
<section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Emails Per Week</h2></div></p>
<img class="" src="figures/EmailsPerWeek.png" >
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>What about scale</h2></div>It actually seems like <em>hard</em> weeks get easier. This feels more realistic.</p>
<br>
<img class="" src="figures/ExpandingMax.png" >
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Putting it together</h2></div></p>
<br>
<img class="" src="figures/EmailsPlusStress.png" >
</section>
</section><section class="vertical-stack">
<section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Sex Quantification</h2></div></p>
<br>
<p>
<div display='inline' align='left'>I've tried multiple tools for keeping the data.</div></p>
<br>
<ol><li>Daytum</li>
<li>TrackThisForMe</li>
<li>Google Spreadsheets</li></ol>
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Data Collection</h2></div></p>
<br>
<p>
<div display='inline' align='left'>I track 3 main things:</div></p>
<br>
<ol><li>Activities</li>
<li>My Satisfaction (0-10)</li>
<li>Her Satisfaction (0-10) <em>inferred</em></li></ol>
<br>
<p>
<div display='inline' align='left'>I enter data shortly afterwards. I then enter the <em>again</em> data the next morning. Results shown are averages of the two points.</div></p>
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Sex Quantification</h2></div></p>
<pre><code class=python>import pandas as pd

sex_data = pd.read_csv('projectdata/willdata.tsv', 
            sep = '\t', 
            parse_dates = [0], 
            index_col=0)
stress_data = pd.read_csv('results/stress.tsv', sep = '\t', parse_dates = [0])
final_data = pd.merge(sex_data, stress_data.groupby('nDateTime')[['Stress']].first(),
                      left_index=True, 
                      right_index = True,
                      how = 'left')
final_data.head()</code></pre>
<br>
<img class="" src="images/DataCollection.png" >
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Frequency</h2></div></p>
<br>
<img class="" src="figures/frequency.png" >
</section>
</section><section class="vertical-stack">
<section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Crazy Statistics</h2></div></p>
<br>
<p>
<div display='inline' align='left'>Use Linear Models to find the effect of the variables on both my and her rankings.</div></p>
<br>
<p>
<div display='inline' align='left'>This is trivially accomplished using <code>statsmodels</code>.</div></p>
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h3>Linear Models</h3></div></p>
<br>
<pre><code class=python>import statsmodels.formula.api as smf
eqn = 'HerRanking ~ PreOrgs + missionary + doggy + cowgirl + reversecowgirl + kinky + Stress'
res = smf.ols(eqn, data = final_data).fit()
res.summary()</code></pre>
<br>
<img class="" src="images/RegressionSummary.png" >
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Observation</h2></div></p>
<br>
<p>
<div display='inline' align='left'>Stress is <strong>not</strong> correlated with her statisfaction or mine.</div></p>
</section>
</section><section class="vertical-stack">
<section class="vertical-slide" >
<p>
<div display='inline' align='left'><h3>Partial Residual Plot</h3></div><div display='inline' align='left'>A way to show the effect of an indepedent variable on the response variable after subtracting the effect of other items in the model.</div></p>
<br>
<p>
<a href="http://en.wikipedia.org/wiki/Partial_residual_plot">Wikipedia Partial Residual Plots</a></p>
</section><section class="vertical-slide" >
<p>
<h2>Stress</h2></p>
<br>
<img class="" src="figures/preference_Stress.png" >
</section><section class="vertical-slide" >
<p>
<h2><em>Foreplay</em> orgasms</h2></p>
<br>
<img class="" src="figures/preference_PreOrgs.png" >
</section><section class="vertical-slide" >
<p>
<h2>Cowgirl</h2></p>
<br>
<img class="" src="figures/preference_cowgirl.png" >
</section><section class="vertical-slide" >
<p>
<h2>Booze</h2></p>
<br>
<img class="" src="figures/preference_booze.png" >
</section><section class="vertical-slide" >
<p>
<h2>Summary</h2></p>
<br>
<img class="" src="figures/effect_heatmap.png" >
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h2>Observation</h2></div></p>
<br>
<p>
Different strokes for different folks.</p>
</section>
</section><section class="vertical-stack">
<section class="vertical-slide" >
<p>
<div display='inline' align='left'><h3>Want to do an analysis like this?</h3></div></p>
<br>
<p>
This is all on Github.</p>
<br>
<p>
<a href="http://github.com/judowill/sextalk/">http://github.com/judowill/sextalk/</a><br><a href="http://judowill.github.io/sextalk/">http://judowill.github.io/sextalk/</a></p>
</section><section class="vertical-slide" >
<p>
<div display='inline' align='left'><h3>How were these slides made?</h3></div></p>
<br>
<p>
<div display='inline' align='left'><h3>JavaScript : <a href="http://hakim.se/projects/reveal-js">reveal.js</a></h3></div><div display='inline' align='left'><h3>Markdown : <a href="http://daringfireball.net/">Daring Fireball</a></h3></div></p>
<br>
<hr>
<br>
<p>
<div display='inline' align='left'><h3>Markdown to HTML: <a href="https://github.com/thoppe/md2reveal">md2reveal.py</a></h3></div><div display='inline' align='left'><em> (Written by a former Judo student of mine)</em></div></p>
</section>
</section>
    </div></div>

    <script src="reveal.js/lib/js/head.min.js"></script>
    <script src="reveal.js/js/reveal.min.js"></script>

    <script>
      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
      overview: true, height: 700, keyboard: true, touch: true, hideAddressBar: true, rollingLinks: false, mouseWheel: false, controls: true, width: 960, viewDistance: 3, rtl: false, progress: true, fragments: true, autoSlide: 0, autoSlideStoppable: true, backgroundtransition: "default", transitionSpeed: "default", center: true, embedded: true, transition: "default", maxScale: 1.2, minScale: 0.2, previewLinks: false, margin: 0.05, loop: false, history: true, 
      
      theme: Reveal.getQueryHash().theme, 
      // available themes are in reveal.js/css/theme

      // Optional libraries used to extend on reveal.js
      dependencies: [ { src: 'reveal.js/lib/js/classList.js', condition: function() { 
    return !document.body.classList; } },

{ src: 'reveal.js/plugin/markdown/showdown.js', condition: function() { 
    return !!document.querySelector( '[data-markdown]' ); } },

{ src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { 
    return !!document.querySelector( '[data-markdown]' ); } },

{ src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: 
  function() { hljs.initHighlightingOnLoad(); } },

{ src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: 
  function() { return !!document.body.classList; } },
 ]

      });
    </script>

  </body>
</html>
